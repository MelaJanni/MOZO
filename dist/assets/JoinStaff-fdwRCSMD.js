import{u as a,r as s,o as e,c as i,a as n,b as l,d as t,t as o,e as r,f as c,w as u,g as d,h as v}from"./vendor-CC72n-b_.js";import{q as p,u as g,s as h,B as f,t as m}from"./index-D5J99yGU.js";import"./bootstrap--QliLv9A.js";const b={class:"join-staff-container"},_={class:"join-card"},k={class:"join-header"},y=["src"],j={key:0,class:"loading-section"},S={key:1,class:"success-section"},A={key:0,class:"staff-info"},I={key:2,class:"error-section"},C={key:0,class:"auth-options"},P={key:3,class:"auth-section"},T={class:"auth-options"},q=p({__name:"JoinStaff",setup(p){const q=a(),w=d(),x=g(),R=q.params.token,B=s(!1),E=s(""),L=s(""),O=s(null),z=()=>{localStorage.setItem("redirectAfterLogin",q.fullPath),w.push("/login")},D=()=>{localStorage.setItem("redirectAfterLogin",q.fullPath),w.push("/register")};return e(()=>{R?x.isAuthenticated&&(async()=>{var a,s;if(x.isAuthenticated){B.value=!0,E.value="";try{const a=x.getUser(),s=await m.joinStaffWithToken(R,{user_id:a.id});O.value=s.data.data,L.value=s.data.message,setTimeout(()=>{w.push("/waiter")},3e3)}catch(e){E.value=(null==(s=null==(a=e.response)?void 0:a.data)?void 0:s.message)||"Error al unirse al negocio"}finally{B.value=!1}}else E.value="Debes iniciar sesión para unirte al negocio"})():E.value="Token de invitación inválido"}),(a,s)=>{var e;return v(),i("div",b,[n("div",_,[n("div",k,[n("img",{src:t(h),alt:"MOZO",class:"logo"},null,8,y),s[0]||(s[0]=n("h1",null,"Invitación de Trabajo",-1)),s[1]||(s[1]=n("p",null,"Has sido invitado a unirte a un negocio como miembro del personal",-1))]),B.value?(v(),i("div",j,s[2]||(s[2]=[n("div",{class:"loading-spinner"},null,-1),n("p",null,"Procesando invitación...",-1)]))):L.value?(v(),i("div",S,[s[5]||(s[5]=n("div",{class:"success-icon"},[n("i",{class:"bi bi-check-circle-fill"})],-1)),s[6]||(s[6]=n("h2",null,"¡Bienvenido al equipo!",-1)),n("p",null,o(L.value),1),O.value?(v(),i("div",A,[n("p",null,[s[3]||(s[3]=n("strong",null,"Negocio:",-1)),r(" "+o(null==(e=O.value.business)?void 0:e.name),1)]),n("p",null,[s[4]||(s[4]=n("strong",null,"Cargo:",-1)),r(" "+o(O.value.position),1)])])):l("",!0),s[7]||(s[7]=n("p",{class:"redirect-message"}," Serás redirigido al panel de mozo en unos segundos... ",-1))])):E.value?(v(),i("div",I,[s[10]||(s[10]=n("div",{class:"error-icon"},[n("i",{class:"bi bi-exclamation-triangle-fill"})],-1)),s[11]||(s[11]=n("h2",null,"Error",-1)),n("p",null,o(E.value),1),E.value.includes("iniciar sesión")?(v(),i("div",C,[c(f,{onClick:z,variant:"primary",class:"auth-button"},{default:u(()=>s[8]||(s[8]=[r(" Iniciar Sesión ")])),_:1,__:[8]}),c(f,{onClick:D,variant:"secondary",class:"auth-button"},{default:u(()=>s[9]||(s[9]=[r(" Registrarse ")])),_:1,__:[9]})])):l("",!0)])):t(x).isAuthenticated?l("",!0):(v(),i("div",P,[s[14]||(s[14]=n("div",{class:"auth-icon"},[n("i",{class:"bi bi-person-check"})],-1)),s[15]||(s[15]=n("h2",null,"Autenticación Requerida",-1)),s[16]||(s[16]=n("p",null,"Para aceptar esta invitación, necesitas iniciar sesión o crear una cuenta.",-1)),n("div",T,[c(f,{onClick:z,variant:"primary",class:"auth-button"},{default:u(()=>s[12]||(s[12]=[r(" Iniciar Sesión ")])),_:1,__:[12]}),c(f,{onClick:D,variant:"secondary",class:"auth-button"},{default:u(()=>s[13]||(s[13]=[r(" Registrarse ")])),_:1,__:[13]})])]))])])}}},[["__scopeId","data-v-d54c133b"]]);export{q as default};
